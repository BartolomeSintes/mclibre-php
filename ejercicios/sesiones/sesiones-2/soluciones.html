<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <title>Sesiones (2). Soluciones. Ejercicios (sesiones). PHP. Bartolomé Sintes Marco. www.mclibre.org</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../../varios/php.css" title="mclibre">
  <link rel="icon" href="../../../varios/favicon.svg">
  <link rel="stylesheet" href="../../../varios/prism.css">
  <script src="../../../varios/prism.js"></script>
  <script src="../../../varios/mclibre.js"></script>
</head>

<body>
  <h1>Ejercicios (sesiones) - Sesiones (2) - Soluciones</h1>

  <nav>
    <p>
      <a href="../../../index.html"><img src="../../../varios/iconos/icono-php.svg" alt="Índice de PHP" title="Índice de PHP" width="48" height="48"></a>
      <a href="#"><img src="../../../varios/iconos/icono-arrow-circle-up.svg" alt="Principio de la página" title="Principio de la página" width="36" height="36"></a>
    </p>

    <div class="toc">
      <h2>Sesiones (2)</h2>

      <h3><a href="index.html">Enunciados</a></h3>
      <ul>
        <li><a href="index.html#formularios">Formularios</a>
          <ul>
            <li><a href="index.html#ejercicio-01">01 - Formulario tres pasos</a></li>
            <li><a href="index.html#ejercicio-02">02 - Form. de confirmación</a></li>
            <li><a href="index.html#ejercicio-03">03 - Form. independientes</a></li>
          </ul>
        </li>
        <li><a href="index.html#graficos">Gráficos</a>
          <ul>
            <li><a href="index.html#ejercicio-11">11 - Quita cartas</a></li>
            <li><a href="index.html#ejercicio-12">12 - Hucha de monedas</a></li>
            <li><a href="index.html#ejercicio-13">13 - Cara o cruz</a></li>
          </ul>
        </li>
      </ul>

      <h3><a href="#">Soluciones</a></h3>
      <ul>
        <li><a href="#formularios">Formularios</a>
          <ul>
            <li><a href="#ejercicio-01">01 - Formulario tres pasos</a></li>
            <li><a href="#ejercicio-02">02 - Form. de confirmación</a></li>
            <li><a href="#ejercicio-03">03 - Form. independientes</a></li>
          </ul>
        </li>
        <li><a href="#graficos">Gráficos</a>
          <ul>
            <li><a href="#ejercicio-11-a">11 - Quita cartas - A</a></li>
            <li><a href="#ejercicio-11-b">11 - Quita cartas - B</a></li>
            <li><a href="#ejercicio-12">12 - Hucha de monedas</a></li>
            <li><a href="#ejercicio-13-a">13 - Cara o cruz - A</a></li>
            <li><a href="#ejercicio-13-b">13 - Cara o cruz - B</a></li>
          </ul>
        </li>
      </ul>
    </div>
  </nav>

  <p>En esta página se muestran una parte de las soluciones de los ejercicios <a href="index.html">Sesiones (2)</a>.</p>

  <p>Si lo prefiere, puede <a href="../../../soluciones/con-sesiones/cs-sesiones-2-soluciones.zip">descargar unas posibles soluciones completas</a> de estos ejercicios.</p>

  <p><img src="../../../varios/iconos/icono-warning.svg" alt="¡Atención!" title="¡Atención!" width="55" height="48">Para hacer estos ejercicios, se recomienda seguir el recorrido de la aplicación, suponiendo que el usuario introduce datos. Pero una vez completada la aplicación hay que comprobar desde el principio (cerrando el navegador previamente) que la aplicación funciona correctamente (es decir, que la aplicación tiene en cuenta que la primera vez que se ejecuta, todavía no hay datos).</p>

  <section id="formularios">
    <h2>Formularios</h2>

    <section id="ejercicio-01">
      <h3>Sesiones (2) 01 - Formulario en dos pasos</h3>

      <p>sesiones-2-01-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-01");
session_start();

// Borrramos los datos guardados en intentos anteriores
// salvo el avisoNombre que puede tener que mostrarse en esta página
unset($_SESSION["nombre"]);
unset($_SESSION["apellidos"]);
unset($_SESSION["avisoApellidos"]);
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Formulario en dos pasos (Formulario 1)&lt;/h1&gt;
  &lt;form action="sesiones-2-01-2.php" method="get"&gt;
    &lt;p&gt;Escriba su nombre:&lt;/p&gt;

&lt;?php
// Si hay un aviso guardado en la sesión, ...
if (isset($_SESSION["avisoNombre"])) {
    // lo mostramos
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Nombre: &lt;input type=\"text\" name=\"nombre\" size=\"20\" maxlength=\"20\"&gt;&lt;/label&gt;\n";
    print "      &lt;span class=\"aviso\"&gt;$_SESSION[avisoNombre]&lt;/span&gt;&lt;/p&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
} else {
    // si no, no mostramos el aviso
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Nombre: &lt;input type=\"text\" name=\"nombre\" size=\"20\" maxlength=\"20\"&gt;&lt;/label&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-2-01-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-01");
session_start();

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos el nombre
$nombre = recoge("nombre");

// Comprobamos el nombre
if ($nombre == "") {
    // Si no hay nombre, guardamos el aviso en la sesión
    $_SESSION["avisoNombre"] = "No ha escrito su nombre";
    // y volvemos a la página 1
    header("Location:sesiones-2-01-1.php");
    exit;
} else {
    // Si hay nombre, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["avisoNombre"]);
    // guardamos el nombre en la sesión
    $_SESSION["nombre"] = $nombre;
    // y pasamos a la página 3
    header("Location:sesiones-2-01-3.php");
    exit;
}</code>
</pre>
      </div>

      <p>sesiones-2-01-3.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-01");
session_start();

// Si accedemos a esta página sin haber guardado antes un nombre en la sesión ...
if (!isset($_SESSION["nombre"])) {
    // volvemos a la página 1
    header("Location:sesiones-2-01-1.php");
    exit;
}
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Formulario en dos pasos (Formulario 2)&lt;/h1&gt;

  &lt;form action="sesiones-2-01-4.php" method="get"&gt;
    &lt;p&gt;Escriba sus apellidos:&lt;/p&gt;

&lt;?php
// Si hay un aviso guardado en la sesión, ...
if (isset($_SESSION["avisoApellidos"])) {
    // lo mostramos
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Apellidos: &lt;input type=\"text\" name=\"apellidos\" size=\"30\" maxlength=\"30\"&gt;&lt;/label&gt;\n";
    print "      &lt;span class=\"aviso\"&gt;$_SESSION[avisoApellidos]&lt;/span&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
} else {
    // si no, no mostramos el aviso
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Apellidos: &lt;input type=\"text\" name=\"apellidos\" size=\"30\" maxlength=\"30\"&gt;&lt;/label&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-2-01-4.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-01");
session_start();

// Si accedemos a esta página sin haber guardado antes un nombre en la sesión ...
if (!isset($_SESSION["nombre"])) {
    // volvemos a la página 1
    header("Location:sesiones-2-01-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos los apellidos
$apellidos = recoge("apellidos");

if ($apellidos == "") {
    // Si no hay apellidos, guardamos el aviso en la sesión
    $_SESSION["avisoApellidos"] = "No ha escrito sus apellidos";
    // y volvemos a la página 3
    header("Location:sesiones-2-01-3.php");
    exit;
} else {
    // Si hay apellidos, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["avisoApellidos"]);
    // guardamos los apellidos en la sesión
    $_SESSION["apellidos"] = $apellidos;
    // y pasamos a la página 5
    header("Location:sesiones-2-01-5.php");
    exit;
}
</code>
</pre>
      </div>

      <p>sesiones-2-01-5.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-01");
session_start();

// Si accedemos a esta página sin haber guardado antes un nombre y unos apellidos en la sesión ...
if (!isset($_SESSION["nombre"]) || !isset($_SESSION["apellidos"])) {
    // volvemos a la página 1
    header("Location:sesiones-2-01-1.php");
    exit;
}
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Formulario en dos pasos (Resultado)&lt;/h1&gt;

&lt;?php
    // Mostramos los datos recibidos
    print "  &lt;p&gt;Su nombre y apellidos son: &lt;strong&gt;$_SESSION[nombre] $_SESSION[apellidos]&lt;/strong&gt;.&lt;/p&gt;\n";
print "\n";
?&gt;
// ...</code>
</pre>
      </div>
    </section>

    <section id="ejercicio-02">
      <h3>Sesiones (2) 02 - Formulario de confirmación</h3>

      <p>sesiones-2-02-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-02");
session_start();

// Borrramos los datos guardados en intentos anteriores
// salvo el aviso1 que puede tener que mostrarse en esta página
unset($_SESSION["palabra1"]);
unset($_SESSION["palabra2"]);
unset($_SESSION["aviso2"]);
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Formulario de confirmación (Formulario 1)&lt;/h1&gt;

  &lt;form action="sesiones-2-02-2.php" method="get"&gt;
    &lt;p&gt;Escriba una palabra (con letras mayúsculas, letras minúsculas y números):&lt;/p&gt;

&lt;?php
// Si hay un aviso guardado en la sesión, ...
if (isset($_SESSION["aviso1"])) {
    // lo mostramos
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Palabra: &lt;input type=\"text\" name=\"palabra1\" size=\"20\" maxlength=\"20\"&gt;&lt;/label&gt;\n";
    print "      &lt;span class=\"aviso\"&gt;$_SESSION[aviso1]&lt;/span&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
} else {
    // si no, no mostramos el aviso
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Palabra: &lt;input type=\"text\" name=\"palabra1\" size=\"20\" maxlength=\"20\"&gt;&lt;/label&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-2-02-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-02");
session_start();

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la palabra1
$palabra1 = recoge("palabra1");

// Comprobamos la palabra1
if ($palabra1 == "") {
    // Si no hay palabra1, guardamos el aviso en la sesión
    $_SESSION["aviso1"] = "No ha escrito nada";
    // y volvemos a la página 1
    header("Location:sesiones-2-02-1.php");
    exit;
} elseif (!ctype_alnum($palabra1)) {
    // Si la palabra1 no son todo letras o números, guardamos el aviso en la sesión
    $_SESSION["aviso1"] = "No ha escrito una sola palabra con letras y números";
    // y volvemos a la página 1
    header("Location:sesiones-2-02-1.php");
    exit;
} else {
    // Si hay palabra1, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["aviso1"]);
    // guardamos la palabra1 en la sesión
    $_SESSION["palabra1"] = $palabra1;
    // y pasamos a la página 3
    header("Location:sesiones-2-02-3.php");
    exit;
}</code>
</pre>
      </div>

      <p>sesiones-2-02-3.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-02");
session_start();

// Si accedemos a esta página sin haber guardado antes la palabra1 en la sesión ...
if (!isset($_SESSION["palabra1"])) {
    // volvemos a la página 1
    header("Location:sesiones-2-02-1.php");
    exit;
}
?&gt;
&lt;!DOCTYPE html&gt;
// ...

&lt;body&gt;
  &lt;h1&gt;Formulario de confirmación (Formulario 2)&lt;/h1&gt;

  &lt;form action="sesiones-2-02-4.php" method="get"&gt;
    &lt;p&gt;Repita la palabra que acaba de escribir:&lt;/p&gt;

&lt;?php
// Si hay un aviso guardado en la sesión, ...
if (isset($_SESSION["aviso2"])) {
    // lo mostramos
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Escriba de nuevo: &lt;input type=\"text\" name=\"palabra2\" size=\"30\" maxlength=\"30\"&gt;&lt;/label&gt;\n";
    print "      &lt;span class=\"aviso\"&gt;$_SESSION[aviso2]&lt;/span&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
} else {
    // si no, no mostramos el aviso
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Escriba de nuevo: &lt;input type=\"text\" name=\"palabra2\" size=\"30\" maxlength=\"30\"&gt;&lt;/label&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-2-02-4.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-02");
session_start();

// Si accedemos a esta página sin haber guardado antes una palabra1 en la sesión ...
if (!isset($_SESSION["palabra1"])) {
    // volvemos a la página 1
    header("Location:sesiones-2-02-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la palabra2
$palabra2 = recoge("palabra2");

if ($palabra2 == "") {
    // Si no hay palabra2, guardamos el aviso en la sesión
    $_SESSION["aviso2"] = "No ha escrito nada";
    // y volvemos a la página 3
    header("Location:sesiones-2-02-3.php");
    exit;
} elseif (!ctype_alnum($palabra2)) {
    // Si la palabra2 no son todo letras o números, guardamos el aviso en la sesión
    $_SESSION["aviso2"] = "No ha escrito una sola palabra con letras y números";
    // y volvemos a la página 3
    header("Location:sesiones-2-02-3.php");
    exit;
} elseif ($_SESSION["palabra1"] != $palabra2) {
    // Si las palabras son distintas, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["aviso2"]);
    // Guardamos el aviso en la sesión
    $_SESSION["aviso1"] = "No ha escrito la misma palabra. Comience de nuevo.";
    // y volvemos a la página 1
    header("Location:sesiones-2-02-1.php");
    exit;
} else {
    // Si hay palabra2, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["aviso2"]);
    // guardamos la palabra2 en la sesión
    $_SESSION["palabra2"] = $palabra2;
    // y pasamos a la página 5
    header("Location:sesiones-2-02-5.php");
    exit;
}</code>
</pre>
      </div>

      <p>sesiones-2-02-5.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-02");
session_start();

// Si accedemos a esta página sin haber guardado antes la palabra1 y la palabra2 en la sesión ...
if (!isset($_SESSION["palabra1"]) || !isset($_SESSION["palabra2"])) {
    // volvemos a la página 1
    header("Location:sesiones-2-01-1.php");
    exit;
}
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Formulario de confirmación (Resultado)&lt;/h1&gt;

&lt;?php
    // Mostramos la palabra confirmada
    print "  &lt;p&gt;Ha escrito y confirmado la palabra: &lt;strong&gt;$_SESSION[palabra1]&lt;/strong&gt;.&lt;/p&gt;\n";
print "\n";
?&gt;
// ...</code>
</pre>
      </div>
    </section>

    <section id="ejercicio-03">
      <h3>Sesiones (2) 03 - Formularios independientes</h3>

      <p>index.php</p>

      <p>La página index.php no contiene código PHP.</p>

      <p>nombre-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-03");
session_start();
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Nombre (1)&lt;/h1&gt;

&lt;?php
// Si hay un nombre guardado en la sesión, ...
if (isset($_SESSION["nombre"])) {
    // lo mostramos
    print "  &lt;p&gt;Usted ya ha escrito que su nombre es: &lt;strong&gt;$_SESSION[nombre]&lt;/strong&gt;&lt;/p&gt;\n";
}
?&gt;

  &lt;form action="nombre-2.php" method="get"&gt;
    &lt;p&gt;Escriba su nombre:&lt;/p&gt;

&lt;?php
// Si hay un aviso guardado en la sesión, ...
if (isset($_SESSION["avisoNombre"])) {
    // lo mostramos
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Nombre: &lt;input type=\"text\" name=\"nombre\" size=\"20\" maxlength=\"20\"&gt;&lt;/label&gt;\n";
    print "      &lt;span class=\"aviso\"&gt;$_SESSION[avisoNombre]&lt;/span&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
} else {
    // si no, no mostramos el aviso
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Nombre: &lt;input type=\"text\" name=\"nombre\" size=\"20\" maxlength=\"20\"&gt;&lt;/label&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>nombre-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-03");
session_start();

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos el nombre
$nombre = recoge("nombre");

if ($nombre == "") {
    // Si no hay nombre, guardamos el aviso en la sesión
    $_SESSION["avisoNombre"] = "No ha escrito su nombre";
    // y volvemos a la página nombre-1
    header("Location:nombre-1.php");
    exit;
} else {
    // Si hay nombre, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["avisoNombre"]);
    // guardamos el nombre en la sesión
    $_SESSION["nombre"] = $nombre;
    // y volvemos a index
    header("Location:index.php");
    exit;
}</code>
</pre>
      </div>

      <p>apellidos-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-03");
session_start();
?&gt;
&lt;!DOCTYPE html&gt;
// ...
&lt;body&gt;
  &lt;h1&gt;Apellidos (1)&lt;/h1&gt;

&lt;?php
// Si hay unos apellidos guardados en la sesión, ...
if (isset($_SESSION["apellidos"])) {
    // lo mostramosn
    print "  &lt;p&gt;Usted ya ha escrito que sus apellidos son: &lt;strong&gt;$_SESSION[apellidos]&lt;/strong&gt;&lt;/p&gt;\n";
    print "\n";
}
?&gt;
  &lt;form action="apellidos-2.php" method="get"&gt;
    &lt;p&gt;Escriba sus apellidos:&lt;/p&gt;

&lt;?php
// Si hay un aviso guardado en la sesión, ...
if (isset($_SESSION["avisoApellidos"])) {
    // lo mostramos
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Apellidos: &lt;input type=\"text\" name=\"apellidos\" size=\"30\" maxlength=\"30\"&gt;&lt;/label&gt;\n";
    print "      &lt;span class=\"aviso\"&gt;$_SESSION[avisoApellidos]&lt;/span&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
} else {
    // si no, no mostramos el aviso
    print "    &lt;p&gt;\n";
    print "      &lt;label&gt;Apellidos: &lt;input type=\"text\" name=\"apellidos\" size=\"30\" maxlength=\"30\"&gt;&lt;/label&gt;\n";
    print "    &lt;/p&gt;\n";
    print "\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>apellidos-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-03");
session_start();

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos los apellidos
$apellidos = recoge("apellidos");

if ($apellidos == "") {
    // Si no hay apellidos, guardamos el aviso en la sesión
    $_SESSION["avisoApellidos"] = "No ha escrito sus apellidos";
    // y volvemos a la página apellidos-1
    header("Location:apellidos-1.php");
    exit;
} else {
    // Si hay apellidos, borramos el aviso que se podría haber generado en intentos anteriores,
    unset($_SESSION["avisoApellidos"]);
    // guardamos los apellidos en la sesión
    $_SESSION["apellidos"] = $apellidos;
    // y volvemos a index
    header("Location:index.php");
    exit;
}</code>
</pre>
      </div>

      <p>ver.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-03");
session_start();
?&gt;
&lt;!DOCTYPE html&gt;
// ...

&lt;body&gt;
  &lt;h1&gt;Ver datos&lt;/h1&gt;

&lt;?php
if (!isset($_SESSION["nombre"]) and !isset($_SESSION["apellidos"])) {
    // Si no hay nombre ni apellidos en la sesión, lo dice
    print "  &lt;p&gt;Usted no ha escrito todavía ni su nombre ni sus apellidos&lt;/p&gt;\n";
} elseif (isset($_SESSION["nombre"]) and !isset($_SESSION["apellidos"])) {
    // Si hay nombre pero no hay apellidos en la sesión, lo dice
    print "  &lt;p&gt;Usted &lt;strong&gt;sólo&lt;/strong&gt; ha escrito que su nombre es: &lt;strong&gt;$_SESSION[nombre]&lt;/strong&gt;&lt;/p&gt;\n";
} elseif (!isset($_SESSION["nombre"]) and isset($_SESSION["apellidos"])) {
    // Si no hay nombre pero sí apellidos en la sesión, lo dice
    print "  &lt;p&gt;Usted &lt;strong&gt;sólo&lt;/strong&gt; ha escrito que sus apellidos son: &lt;strong&gt;$_SESSION[apellidos]&lt;/strong&gt;&lt;/p&gt;\n";
} else {
    // Si hay nombre y apellidos en la sesión, lo dice
    print "  &lt;p&gt;Usted ha escrito que su nombre es: &lt;strong&gt;$_SESSION[nombre]&lt;/strong&gt;&lt;/p&gt;\n";
    print "\n";
    print "  &lt;p&gt;Usted ha escrito que sus apellidos son: &lt;strong&gt;$_SESSION[apellidos]&lt;/strong&gt;&lt;/p&gt;\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>borrar.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php

// Accedemos a la sesión
session_name("sesiones-2-03");
session_start();
// Destruimos la sesión
session_destroy();

?&gt;
&lt;!DOCTYPE html&gt;
// ...</code>
</pre>
      </div>
    </section>
  </section>

  <section id="graficos">
    <h2>Gráficos</h2>

    <section id="ejercicio-11-a">
      <h3>Sesiones (2) 11 - Quita cartas (ejercicio examen curso 2017/18) - Solución A</h3>

      <p>En esta solución se utilizan dos variables de sesión (el número de cartas a mostrar y el mensaje a mostrar). De esta manera, la primera página sólo escribe los valores de las variables de sesión. Toda la "lógica" del programa está en la segunda página.</p>

      <p>sesiones-1-11-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-11");
session_start();

// Si falta una de los dos variables de sesión, reiniciamos los valores
if (!isset($_SESSION["cartas"], $_SESSION["mensaje"])) {
    $_SESSION["cartas"]  = rand(3, 10);
    $_SESSION["mensaje"] = "  &lt;p&gt;Quedan $_SESSION[cartas] cartas. Haga clic en el dibujo para eliminar una carta.&lt;/p&gt;\n";
}

?&gt;
&lt;!DOCTYPE html&gt;
// ...

&lt;body&gt;
  &lt;h1&gt;Quita cartas&lt;/h1&gt;

&lt;?php
// Escribimos el mensaje
print $_SESSION["mensaje"];
?&gt;

  &lt;form action="sesiones-2-11-2.php"&gt;
    &lt;p&gt;
      &lt;button type="submit" name="quita" value="quita" style="background-color: #eee;"&gt;
        &lt;svg version="1.1" xmlns="http://www.w3.org/2000/svg"
          width="210" height="250" viewBox="-10 -10 210 250"&gt;
          &lt;defs&gt;
            &lt;pattern id="patron-1" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse" &gt;
              &lt;rect x="0" y="0" width="10" height="10" fill="hwb(0 60% 0%)" /&gt;
              &lt;line x1="0" y1="10" x2="10" y2="0" stroke="hwb(0 80% 0%)" stroke-width="1" /&gt;
              &lt;line x1="0" y1="0" x2="10" y2="10" stroke="hwb(0 80% 0%)" stroke-width="1" /&gt;
            &lt;/pattern&gt;
          &lt;/defs&gt;

&lt;?php
// Hacemos un bucle para dibujar el número de cartas guardado en la sesión
for ($i = 0; $i &lt; $_SESSION["cartas"]; $i++) {
    $pos = 10 * $i;
    print "          &lt;rect x=\"$pos\" y=\"$pos\" width=\"100\" height=\"140\" rx=\"5\" ry=\"5\" style=\"stroke: black; fill: url(#patron-1);\" /&gt;\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-1-11-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-11");
session_start();

// Si falta una de los dos variables de sesión, redirigimos a la primera página
if (!isset($_SESSION["cartas"], $_SESSION["mensaje"])) {
    header("Location:sesiones-2-11-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la orden de quitar una carta
$quita = recoge("quita");

// Si hemos recibido la orden de quitar una carta ...
if ($quita == "quita") {
    // reducimos el número de cartas a mostrar guardado
    $_SESSION["cartas"] -= 1;
    // Si el número de cartas a mostrar guardado era cero y al reducirlo se hace negativo ...
    if ($_SESSION["cartas"] &lt; 0) {
        // lo generamos al azar
        $_SESSION["cartas"] = rand(3, 10);
    }
    // Guardamos el mensaje correspondiente al número de cartas
    if ($_SESSION["cartas"] == 0) {
        $_SESSION["mensaje"] = "  &lt;p&gt;No quedan cartas. Haga clic en el dibujo para volver a poner cartas.&lt;/p&gt;\n";
    } elseif ($_SESSION["cartas"] == 1) {
        $_SESSION["mensaje"] = "  &lt;p&gt;Queda $_SESSION[cartas] sola carta. Haga clic en el dibujo para eliminarla.&lt;/p&gt;\n";
    } else {
        $_SESSION["mensaje"] = "  &lt;p&gt;Quedan $_SESSION[cartas] cartas. Haga clic en el dibujo para eliminar una carta.&lt;/p&gt;\n";
    }
}

// Volvemos a la primera página
header("Location:sesiones-2-11-1.php");
</code>
</pre>
      </div>
    </section>

    <section id="ejercicio-11-b">
      <h3>Sesiones (2) 11 - Quita cartas (ejercicio examen curso 2017/18) - Solución B</h3>

      <p>En esta solución se utiliza únicamente una variable de sesión (el número de cartas a mostrar). Eso obliga a que en la primera página se tenga que decidir el mensaje a mostrar.</p>

      <p>sesiones-1-11-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-11-b");
session_start();

// Si el número de cartas no está guardado en la sesión, lo generamos al azar
if (!isset($_SESSION["cartas"])) {
    $_SESSION["cartas"] = rand(3, 10);
}

?&gt;
&lt;!DOCTYPE html&gt;
// ...

&lt;body&gt;
  &lt;h1&gt;Quita cartas&lt;/h1&gt;

&lt;?php
if ($_SESSION["cartas"] == 0) {
    // Si no quedan cartas, lo dice
    print "  &lt;p&gt;No quedan cartas. Haga clic en el dibujo para volver a poner cartas.&lt;/p&gt;\n";
} elseif ($_SESSION["cartas"] == 1) {
    // Si no queda una sola carta, lo dice
    print "  &lt;p&gt;Queda $_SESSION[cartas] sola carta. Haga clic en el dibujo para eliminarla.&lt;/p&gt;\n";
} else {
    // Si quedan varias cartas, lo dice
    print "  &lt;p&gt;Quedan $_SESSION[cartas] cartas. Haga clic en el dibujo para eliminar una carta.&lt;/p&gt;\n";
}
?&gt;

  &lt;form action="sesiones-2-11-b-2.php"&gt;
    &lt;p&gt;
      &lt;button type="submit" name="quita" value="quita" style="background-color: #eee;"&gt;
        &lt;svg version="1.1" xmlns="http://www.w3.org/2000/svg"
          width="210" height="250" viewBox="-10 -10 210 250"&gt;
          &lt;defs&gt;
            &lt;pattern id="patron-1" x="0" y="0" width="10" height="10" patternUnits="userSpaceOnUse" &gt;
              &lt;rect x="0" y="0" width="10" height="10" fill="hwb(0 60% 0%)" /&gt;
              &lt;line x1="0" y1="10" x2="10" y2="0" stroke="hwb(0 80% 0%)" stroke-width="1" /&gt;
              &lt;line x1="0" y1="0" x2="10" y2="10" stroke="hwb(0 80% 0%)" stroke-width="1" /&gt;
            &lt;/pattern&gt;
          &lt;/defs&gt;

&lt;?php
for ($i = 0; $i &lt; $_SESSION["cartas"]; $i++) {
    $pos = 10 * $i;
    print "          &lt;rect x=\"$pos\" y=\"$pos\" width=\"100\" height=\"140\" rx=\"5\" ry=\"5\" style=\"stroke: black; fill: url(#patron-1);\" /&gt;\n";
}
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-1-11-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-11-b");
session_start();

// Si el número de cartas no está guardado en la sesión, redirigimos a la primera página
if (!isset($_SESSION["cartas"])) {
    header("Location:sesiones-2-11-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la orden de quitar una carta
$quita = recoge("quita");

// Si hemos recibido la orden de quitar una carta ...
if ($quita == "quita") {
    // reducimos el número de cartas a mostrar guardado
    $_SESSION["cartas"] -= 1;
    // Si el número de cartas a mostrar guardado era cero y al reducirlo se hace negativo ...
    if ($_SESSION["cartas"] &lt; 0) {
        // lo generamos al azar
        $_SESSION["cartas"] = rand(3, 10);
    }
}

// Volvemos a la primera página
header("Location:sesiones-2-11-b-1.php");
</code>
</pre>
      </div>
    </section>

    <section id="ejercicio-12">
      <h3>Sesiones (2) 12 - Hucha de monedas (ejercicio examen curso 2017/18)</h3>

      <p>sesiones-1-12-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-12-1");
session_start();

// Si el ahorro no está guardado en la sesión, inicializamos el valor a cero
if (!isset($_SESSION["ahorro"])) {
    $_SESSION["ahorro"] = 0;
}

?&gt;
&lt;!DOCTYPE html&gt;
// ...
        &lt;/g&gt;
&lt;?php
// Mostramos la cantidad ahorrada
print "        &lt;text x=\"170\" y=\"110\" font-size=\"60\" text-anchor=\"middle\"&gt;$_SESSION[ahorro]&lt;/text&gt;\n";
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-1-12-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-12-1");
session_start();

// Si el ahorro no está guardado en la sesión, redirigimos a la primera página
if (!isset($_SESSION["ahorro"])) {
    header("Location:sesiones-2-12-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la moneda y la acción
$moneda = recoge("moneda");
$accion = recoge("accion");

if ($accion == "Vaciar hucha") {
    // Si la acción es vacíar la hucha, se vacía
    $_SESSION["ahorro"] = 0;
    // } elseif ($moneda == 0.01 || $moneda == 0.02 || $moneda == 0.05 || $moneda == 0.10
    //                                              || $moneda == 0.20 || $moneda == 0.50 || $moneda == 1 || $moneda == 2) {
} elseif (in_array($moneda, [0.01, 0.02, 0.05, 0.10, 0.20, 0.50, 1, 2])) {
    // Si llega una moneda, se añade
    $_SESSION["ahorro"] += $moneda;
}

// Volvemos a la primera página
header("Location:sesiones-2-12-1.php");
</code>
</pre>
      </div>
    </section>

    <section id="ejercicio-13-a">
      <h3>Sesiones (2) 13 - Cara o cruz (ejercicio examen curso 2017/18) - Solución A</h3>

      <p>En esta solución se utilizan cinco variables de sesión (el número de turnos ganados por cada jugador, los dos emojis y la moneda a mostrar). De esta manera, la primera página sólo escribe los valores de las variables de sesión. Toda la "lógica" del programa está en la segunda página.</p>

      <p>sesiones-1-13-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-13");
session_start();

// Si falta una de los dos variables de sesión, reiniciamos los valores
if (!isset($_SESSION["puntosG"], $_SESSION["puntosM"], $_SESSION["moneda"])) {
    $_SESSION["puntosG"] = 0;
    $_SESSION["puntosM"] = 0;
    $_SESSION["moneda"]  = "";
    $_SESSION["caraG"]   = "&amp;#128572;";
    $_SESSION["caraM"]   = "&amp;#128586;";
}

?&gt;
&lt;!DOCTYPE html&gt;
// ..
  &lt;table style="text-align: center;"&gt;
    &lt;tr&gt;
      &lt;th&gt;Jugador A&lt;/th&gt;
      &lt;th&gt;Resultado&lt;/th&gt;
      &lt;th&gt;Jugador B&lt;/th&gt;
    &lt;/tr&gt;
&lt;?php
print "    &lt;tr style=\"font-size: 400%\"&gt;\n";

// Mostramos la puntuación del gato
print "      &lt;td&gt;$_SESSION[puntosG]&lt;/td&gt;\n";
print "      &lt;td&gt;&lt;/td&gt;\n";

// Mostramos la puntuación del mono
print "      &lt;td&gt;$_SESSION[puntosM]&lt;/td&gt;\n";

print "    &lt;/tr&gt;\n";

print "    &lt;tr style=\"font-size: 400%\"&gt;\n";

// Mostramos la cara del gato
print "      &lt;td&gt;$_SESSION[caraG]&lt;/td&gt;\n";

// Mostramos la moneda
print "      &lt;td&gt;$_SESSION[moneda]&lt;/td&gt;\n";

// Mostramos la cara del mono
print "      &lt;td&gt;$_SESSION[caraM]&lt;/td&gt;\n";

print "    &lt;/tr&gt;\n";
?&gt;
// ...</code>
</pre>
      </div>

      <p>sesiones-1-13-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-13");
session_start();

// Si falta una de los dos variables de sesión, redirigimos a la primera página
if (!isset($_SESSION["puntosG"], $_SESSION["puntosM"], $_SESSION["moneda"])) {
    header("Location:sesiones-2-13-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la acción
$siguiente = recoge("siguiente");

if ($siguiente == "Lanzar moneda") {
    // Si la acción es lanzar la moneda ...

    // Lanzamos la moneda
    $moneda = rand(1, 2);

    // Calculamos quién gana el turno y la imagen de la moneda
    if ($moneda == 1) {
        $_SESSION["puntosG"] += 1;
        $_SESSION["moneda"] = "&lt;img src=\"img/a.svg\" alt=\"A\" width=\"100\" height=\"100\"&gt;";
    } else {
        $_SESSION["puntosM"] += 1;
        $_SESSION["moneda"] = "&lt;img src=\"img/b.svg\" alt=\"B\" width=\"100\" height=\"100\"&gt;";
    }

    // Calculamos la cara del gato y del mono
    if ($_SESSION["puntosG"] &gt; $_SESSION["puntosM"]) {
        $_SESSION["caraG"] = "&amp;#128568;";
        $_SESSION["caraM"] = "&amp;#128584;";
    } elseif ($_SESSION["puntosG"] &lt; $_SESSION["puntosM"]) {
        $_SESSION["caraG"] = "&amp;#128576;";
        $_SESSION["caraM"] = "&amp;#128053;";
    } else {
        $_SESSION["caraG"] = "&amp;#128572;";
        $_SESSION["caraM"] = "&amp;#128586;";
    }
} elseif ($siguiente == "Volver a empezar") {
    // Si la acción es volver a empezar, destruimos la sesión
    session_destroy();
}

// Volvemos a la primera página
header("Location:sesiones-2-13-1.php");
</code>
</pre>
      </div>
    </section>

    <section id="ejercicio-13-b">
      <h3>Sesiones (2) 13 - Cara o cruz (ejercicio examen curso 2017/18) - Solución B</h3>

      <p>En esta solución se utilizan únicamente tres variables de sesión (el número de turnos ganados por cada jugador y quién ha ganado el turno). Eso obliga a que en la primera página se tenga que decidir los emojis y la imagen de la moneda a mostrar.</p>

      <p>sesiones-1-13-1.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-13");
session_start();

// Si falta una de los dos variables de sesión, reiniciamos los valores
if (!isset($_SESSION["g"], $_SESSION["m"], $_SESSION["moneda"])) {
    $_SESSION["moneda"] = 0;
    $_SESSION["g"]      = 0;
    $_SESSION["m"]      = 0;
}

?&gt;
&lt;!DOCTYPE html&gt;
// ...
  &lt;table style="text-align: center;"&gt;
    &lt;tr&gt;
      &lt;th&gt;Jugador A&lt;/th&gt;
      &lt;th&gt;Resultado&lt;/th&gt;
      &lt;th&gt;Jugador B&lt;/th&gt;
    &lt;/tr&gt;
&lt;?php
// Mostramos las puntuaciones de cada jugador
print "    &lt;tr style=\"font-size: 400%\"&gt;\n";
print "      &lt;td&gt;$_SESSION[g]&lt;/td&gt;\n";
print "      &lt;td&gt;&lt;/td&gt;\n";
print "      &lt;td&gt;$_SESSION[m]&lt;/td&gt;\n";
print "    &lt;/tr&gt;\n";

// Calculamos la cara del gato
print "    &lt;tr style=\"font-size: 400%\"&gt;\n";
if ($_SESSION["g"] &gt; $_SESSION["m"]) {
    print "      &lt;td&gt;&#128568;&lt;/td&gt;\n";
} elseif ($_SESSION["g"] &lt; $_SESSION["m"]) {
    print "      &lt;td&gt;&#128576;&lt;/td&gt;\n";
} else {
    print "      &lt;td&gt;&#128572;&lt;/td&gt;\n";
}

// Enseñamos la moneda
if ($_SESSION["moneda"] == 0) {
    print "      &lt;td&gt;&lt;/td&gt;\n";
} elseif ($_SESSION["moneda"] == 1) {
    print "      &lt;td&gt;&lt;img src=\"img/a.svg\" alt=\"A\" width=\"100\" height=\"100\"&gt;&lt;/td&gt;\n";
} else {
    print "      &lt;td&gt;&lt;img src=\"img/b.svg\" alt=\"B\" width=\"100\" height=\"100\"&gt;&lt;/td&gt;\n";
}

// Calculamos la cara del mono
if ($_SESSION["g"] &gt; $_SESSION["m"]) {
    print "      &lt;td&gt;&#128584;&lt;/td&gt;\n";
} elseif ($_SESSION["g"] &lt; $_SESSION["m"]) {
    print "      &lt;td&gt;&#128053;&lt;/td&gt;\n";
} else {
    print "      &lt;td&gt;&#128586;&lt;/td&gt;\n";
}
print "    &lt;/tr&gt;\n";
?&gt;</code>
</pre>
      </div>

      <p>sesiones-1-13-2.php</p>

      <div class="codigo">
        <pre>
<code class="language-php">&lt;?php
// Accedemos a la sesión
session_name("sesiones-2-13");
session_start();

// Si falta una de los dos variables de sesión, redirigimos a la primera página
if (!isset($_SESSION["g"], $_SESSION["m"], $_SESSION["moneda"])) {
    header("Location:sesiones-2-13-b-1.php");
    exit;
}

// Función de recogida de datos
function recoge($key, $type = "")
{
    if (!is_string($key) && !is_int($key) || $key == "") {
        trigger_error("Function recoge(): Argument #1 (\$key) must be a non-empty string or an integer", E_USER_ERROR);
    } elseif ($type !== "" && $type !== []) {
        trigger_error("Function recoge(): Argument #2 (\$type) is optional, but if provided, it must be an empty array or an empty string", E_USER_ERROR);
    }
    $tmp = $type;
    if (isset($_REQUEST[$key])) {
        if (!is_array($_REQUEST[$key]) && !is_array($type)) {
            $tmp = trim(htmlspecialchars($_REQUEST[$key]));
        } elseif (is_array($_REQUEST[$key]) && is_array($type)) {
            $tmp = $_REQUEST[$key];
            array_walk_recursive($tmp, function (&$value) {
                $value = trim(htmlspecialchars($value));
            });
        }
    }
    return $tmp;
}

// Recogemos la acción
$siguiente = recoge("siguiente");

if ($siguiente == "Lanzar moneda") {
    // Si la acción es lanzar la moneda ...
    // Lanzamos la moneda
    $_SESSION["moneda"] = rand(1, 2);
    // Calculamos quién gana el turno
    if ($_SESSION["moneda"] == 1) {
        $_SESSION["g"] += 1;
    } else {
        $_SESSION["m"] += 1;
    }
} elseif ($siguiente == "Volver a empezar") {
    // Si la acción es volver a empezar, reiniciamos las variables de sesión
    $_SESSION["moneda"] = 0;
    $_SESSION["g"]      = 0;
    $_SESSION["m"]      = 0;
}

// Volvemos a la primera página
header("Location:sesiones-2-13-b-1.php");
</code>
</pre>
      </div>
    </section>
  </section>

  <footer>
    <p class="ultmod">Última modificación de esta página: 4 de febrero de 2025</p>

    <p class="licencia">
      <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.es"><img src="../../../varios/iconos/icono-cc-by-sa.svg" alt="Licencia Creative Commons" title="Licencia Creative Commons BY-SA" width="120" height="42"></a><br>
      Esta página forma parte del curso <strong><a href="https://www.mclibre.org/consultar/php/">Programación web en PHP</a></strong> por <a href="https://www.mclibre.org/" rel="author">Bartolomé Sintes Marco</a><br>
      que se distribuye bajo una <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/deed.es">Licencia Creative Commons Reconocimiento-CompartirIgual 4.0 Internacional (CC BY-SA 4.0)</a>.
    </p>
  </footer>
</body>
</html>
